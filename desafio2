#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX 10

typedef struct { char nome[30], tipo[20]; int qtd; } Item;
typedef struct No { Item d; struct No* prox; } No;

Item vet[MAX];
int n = 0, compS, compB;
No* lst = NULL;

void addVet(){
    if(n == MAX){ printf("\nFull!\n"); return; }
    printf("\nNome: "); fgets(vet[n].nome,30,stdin);
    vet[n].nome[strcspn(vet[n].nome,"\n")] = 0;
    printf("Tipo: "); fgets(vet[n].tipo,20,stdin);
    vet[n].tipo[strcspn(vet[n].tipo,"\n")] = 0;
    printf("Qtd: "); scanf("%d",&vet[n].qtd); getchar();
    n++; printf("OK!\n");
}

void listVet(){
    if(!n){ printf("\nVazio\n"); return; }
    for(int i=0;i<n;i++)
        printf("%s | %s | %d\n",vet[i].nome,vet[i].tipo,vet[i].qtd);
}

void rmVet(){
    if(!n){ printf("\nVazio\n"); return; }
    char x[30]; printf("\nRemover: "); fgets(x,30,stdin);
    x[strcspn(x,"\n")] = 0;
    for(int i=0;i<n;i++){
        if(!strcmp(vet[i].nome,x)){
            for(int j=i;j<n-1;j++) vet[j]=vet[j+1];
            n--; printf("OK!\n"); return;
        }
    }
    printf("Nao achou\n");
}

void buscaSeqVet(){
    char x[30]; printf("\nNome: "); fgets(x,30,stdin);
    x[strcspn(x,"\n")] = 0; compS = 0;
    for(int i=0;i<n;i++){
        compS++;
        if(!strcmp(vet[i].nome,x)){
            printf("%s | %s | %d\n",vet[i].nome,vet[i].tipo,vet[i].qtd);
            printf("Comp: %d\n",compS); return;
        }
    }
    printf("Nao achou | Comp: %d\n",compS);
}

void sortVet(){
    for(int i=0;i<n-1;i++)
        for(int j=0;j<n-i-1;j++)
            if(strcmp(vet[j].nome,vet[j+1].nome)>0){
                Item t = vet[j]; vet[j]=vet[j+1]; vet[j+1]=t;
            }
    printf("Ordenado!\n");
}

void buscaBinVet(){
    char x[30]; printf("\nNome: "); fgets(x,30,stdin);
    x[strcspn(x,"\n")] = 0; int l=0,r=n-1; compB=0;
    while(l<=r){
        int m=(l+r)/2; compB++;
        int cmp = strcmp(x,vet[m].nome);
        if(!cmp){
            printf("%s | %s | %d\n",vet[m].nome,vet[m].tipo,vet[m].qtd);
            printf("Comp: %d\n",compB); return;
        } else if(cmp>0) l=m+1; else r=m-1;
    }
    printf("Nao achou | Comp: %d\n",compB);
}

void addLst(){
    No* p = malloc(sizeof(No));
    printf("\nNome: "); fgets(p->d.nome,30,stdin);
    p->d.nome[strcspn(p->d.nome,"\n")] = 0;
    printf("Tipo: "); fgets(p->d.tipo,20,stdin);
    p->d.tipo[strcspn(p->d.tipo,"\n")] = 0;
    printf("Qtd: "); scanf("%d",&p->d.qtd); getchar();
    p->prox = lst; lst = p;
    printf("OK!\n");
}

void listLst(){
    No* p = lst; if(!p){ printf("\nVazio\n"); return; }
    while(p){ printf("%s | %s | %d\n",p->d.nome,p->d.tipo,p->d.qtd); p=p->prox; }
}

void rmLst(){
    char x[30]; printf("\nRemover: "); fgets(x,30,stdin);
    x[strcspn(x,"\n")] = 0;
    No *p=lst,*a=NULL;
    while(p){
        if(!strcmp(p->d.nome,x)){
            if(!a) lst=p->prox; else a->prox=p->prox;
            free(p); printf("OK!\n"); return;
        }
        a=p; p=p->prox;
    }
    printf("Nao achou\n");
}

void buscaLst(){
    char x[30]; printf("\nNome: "); fgets(x,30,stdin);
    x[strcspn(x,"\n")] = 0; compS=0;
    No* p=lst;
    while(p){
        compS++;
        if(!strcmp(p->d.nome,x)){
            printf("%s | %s | %d\n",p->d.nome,p->d.tipo,p->d.qtd);
            printf("Comp: %d\n",compS); return;
        }
        p=p->prox;
    }
    printf("Nao achou | Comp: %d\n",compS);
}

int main(){
    int m,o;
    do{
        printf("\n1 Vetor\n2 Lista\n0 Sair\n> ");
        scanf("%d",&m); getchar();
        while(m==1){
            printf("\n1 Add\n2 Rm\n3 List\n4 Busc Seq\n5 Ordenar\n6 Busc Bin\n0 Voltar\n> ");
            scanf("%d",&o); getchar();
            if(o==1)addVet(); else if(o==2)rmVet(); 
            else if(o==3)listVet(); else if(o==4)buscaSeqVet();
            else if(o==5)sortVet(); else if(o==6)buscaBinVet();
            else if(o==0)break;
        }
        while(m==2){
            printf("\n1 Add\n2 Rm\n3 List\n4 Buscar\n0 Voltar\n> ");
            scanf("%d",&o); getchar();
            if(o==1)addLst(); else if(o==2)rmLst(); 
            else if(o==3)listLst(); else if(o==4)buscaLst();
            else if(o==0)break;
        }
    }while(m!=0);
}
